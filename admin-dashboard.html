<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APEC 2025 관리자 대시보드 | 신청 현황 관리</title>
    <meta name="description" content="APEC 정상회의 부대행사 신청 현황 관리자 대시보드">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Airtable API -->
    <script src="airtable-config.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .stat-card {
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .table-container {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .table-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .table-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        
        .table-container::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        
        .table-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        .loading {
            display: none;
        }
        
        .loading.show {
            display: flex;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .badge {
            @apply px-2 py-1 text-xs font-semibold rounded-full;
        }
        
        .badge-traditional {
            @apply bg-red-100 text-red-800;
        }
        
        .badge-kpop {
            @apply bg-purple-100 text-purple-800;
        }
        
        .badge-pending {
            @apply bg-yellow-100 text-yellow-800;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-shield-alt text-2xl mr-3"></i>
                    <div>
                        <h1 class="text-xl font-bold">APEC 2025 관리자 대시보드</h1>
                        <p class="text-sm text-gray-300">신청 현황 및 통계 관리</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="text-right text-sm">
                        <p class="text-gray-300">마지막 업데이트</p>
                        <p id="lastUpdate" class="font-semibold">-</p>
                    </div>
                    
                    <button onclick="refreshData()" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-sync-alt mr-2"></i>
                        새로고침
                    </button>
                    
                    <a href="index.html" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-home mr-2"></i>
                        메인으로
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading fixed inset-0 bg-black/50 items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 text-center">
            <i class="fas fa-spinner fa-spin text-4xl text-blue-500 mb-4"></i>
            <p class="text-gray-700 font-semibold">데이터를 불러오는 중...</p>
        </div>
    </div>

    <main class="container mx-auto px-6 py-8">
        <!-- Statistics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Total Applications -->
            <div class="stat-card glass-card rounded-2xl p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 mb-1">전체 신청</p>
                        <p id="totalCount" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-users text-blue-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- Traditional Dance -->
            <div class="stat-card glass-card rounded-2xl p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 mb-1">전통무용</p>
                        <p id="traditionalCount" class="text-3xl font-bold text-red-600">0</p>
                        <p class="text-xs text-gray-500">정원: 200명</p>
                    </div>
                    <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-fan text-red-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- K-Pop Concert -->
            <div class="stat-card glass-card rounded-2xl p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 mb-1">K-Pop 공연</p>
                        <p id="kpopCount" class="text-3xl font-bold text-purple-600">0</p>
                        <p class="text-xs text-gray-500">정원: 300명</p>
                    </div>
                    <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-microphone-alt text-purple-600 text-xl"></i>
                    </div>
                </div>
            </div>

            <!-- Recent Applications -->
            <div class="stat-card glass-card rounded-2xl p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-gray-600 mb-1">최근 24시간</p>
                        <p id="recentCount" class="text-3xl font-bold text-green-600">0</p>
                        <p class="text-xs text-gray-500">신규 신청</p>
                    </div>
                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-clock text-green-600 text-xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Chart Section -->
            <div class="lg:col-span-1">
                <div class="glass-card rounded-2xl p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">공연별 신청 현황</h3>
                    <div style="height: 300px;">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">빠른 작업</h3>
                    <div class="space-y-3">
                        <button onclick="exportToCSV()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg transition-colors flex items-center justify-center">
                            <i class="fas fa-download mr-2"></i>
                            CSV 내보내기
                        </button>
                        
                        <button onclick="exportToExcel()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg transition-colors flex items-center justify-center">
                            <i class="fas fa-file-excel mr-2"></i>
                            Excel 내보내기
                        </button>
                        
                        <button onclick="clearAllData()" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-3 rounded-lg transition-colors flex items-center justify-center">
                            <i class="fas fa-trash mr-2"></i>
                            모든 데이터 삭제
                        </button>
                    </div>
                </div>
            </div>

            <!-- Applications Table -->
            <div class="lg:col-span-2">
                <div class="glass-card rounded-2xl overflow-hidden">
                    <div class="p-6 border-b border-gray-200">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold text-gray-800">신청 목록</h3>
                            <div class="flex items-center space-x-3">
                                <select id="filterPerformance" onchange="filterData()" class="px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                    <option value="">모든 공연</option>
                                    <option value="traditional">전통무용</option>
                                    <option value="kpop">K-Pop</option>
                                </select>
                                
                                <div class="relative">
                                    <input type="text" id="searchInput" placeholder="이름 또는 이메일 검색" 
                                           class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm w-64" 
                                           oninput="searchData()">
                                    <i class="fas fa-search absolute left-3 top-3 text-gray-400 text-sm"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="w-full">
                            <thead class="bg-gray-50 sticky top-0">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">#</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">이름</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">휴대폰</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">이메일</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">공연</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">신청일시</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">상태</th>
                                </tr>
                            </thead>
                            <tbody id="applicationsTable" class="bg-white divide-y divide-gray-200">
                                <!-- Data will be populated here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Empty State -->
                    <div id="emptyState" class="text-center py-12 hidden">
                        <i class="fas fa-inbox text-gray-300 text-4xl mb-4"></i>
                        <h3 class="text-lg font-semibold text-gray-600 mb-2">신청 데이터가 없습니다</h3>
                        <p class="text-gray-500">아직 신청된 데이터가 없거나 검색 조건에 맞는 결과가 없습니다.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let registrations = [];
        let filteredRegistrations = [];
        let performanceChart = null;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateLastUpdateTime();
            
            // Refresh data every 30 seconds
            setInterval(() => {
                loadData();
                updateLastUpdateTime();
            }, 30000);
        });

        // Load registration data from Airtable
        async function loadData() {
            showLoading();
            
            try {
                // Fetch data from Airtable
                const airtableRecords = await window.airtableAPI.getAllRecords({ maxRecords: 1000 });
                
                // Convert Airtable data format to match existing format
                registrations = airtableRecords.map(record => ({
                    id: record.id,
                    name: record.fields['Name'] || '',
                    phone: record.fields['Phone'] || '',
                    email: record.fields['Email'] || '',
                    performanceType: record.fields['Performance Type'] === 'Traditional' ? 'traditional' : 'kpop',
                    submittedAt: record.fields['Submitted At'] || record.createdTime,
                    status: (record.fields['Status'] || 'Pending').toLowerCase(),
                    createdTime: record.createdTime
                }));
                
                // Also merge with localStorage data (for backup/offline data)
                const localData = JSON.parse(localStorage.getItem('apec_registrations') || '[]');
                
                // Remove duplicates and merge
                const allData = [...registrations];
                localData.forEach(localItem => {
                    // Check if this record already exists in Airtable data
                    const exists = allData.find(item => 
                        item.id === localItem.id || 
                        (item.email === localItem.email && item.name === localItem.name)
                    );
                    
                    if (!exists) {
                        // Add local data with a flag
                        allData.push({
                            ...localItem,
                            isLocalOnly: true
                        });
                    }
                });
                
                registrations = allData;
                filteredRegistrations = [...registrations];
                
                updateStatistics();
                updateChart();
                renderTable();
                
                // Show success message
                showDataLoadSuccess('Airtable');
                
            } catch (error) {
                console.error('Airtable 데이터 로드 실패, localStorage 사용:', error);
                
                // Fallback to localStorage
                registrations = JSON.parse(localStorage.getItem('apec_registrations') || '[]');
                filteredRegistrations = [...registrations];
                
                updateStatistics();
                updateChart();
                renderTable();
                
                // Show warning message
                showApiErrorMessage('Airtable');
            }
            
            hideLoading();
        }
        
        // Show API error message
        function showApiErrorMessage(apiType = 'API') {
            const warningDiv = document.createElement('div');
            warningDiv.className = 'fixed top-4 right-4 bg-yellow-50 border border-yellow-200 rounded-lg p-4 shadow-lg z-50';
            warningDiv.innerHTML = `
                <div class="flex items-start">
                    <i class="fas fa-exclamation-triangle text-yellow-500 mr-3 mt-1"></i>
                    <div>
                        <h4 class="font-semibold text-yellow-800">${apiType} 연결 실패</h4>
                        <p class="text-yellow-700 text-sm">
                            ${apiType === 'Airtable' ? 'Airtable' : '서버'} 데이터를 불러올 수 없어 로컬 데이터를 표시합니다.
                            ${apiType === 'Airtable' ? 'API 키 설정을 확인해주세요.' : ''}
                        </p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-yellow-400 hover:text-yellow-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            document.body.appendChild(warningDiv);
            
            // Auto remove after 10 seconds
            setTimeout(() => {
                if (document.body.contains(warningDiv)) {
                    warningDiv.remove();
                }
            }, 10000);
        }
        
        // Show data load success message
        function showDataLoadSuccess(source) {
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg z-50';
            successDiv.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-check-circle text-green-500 mr-3"></i>
                    <div>
                        <h4 class="font-semibold text-green-800">${source} 연결 성공</h4>
                        <p class="text-green-700 text-sm">최신 데이터를 불러왔습니다.</p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                if (document.body.contains(successDiv)) {
                    successDiv.remove();
                }
            }, 3000);
        }

        // Update statistics
        function updateStatistics() {
            const total = registrations.length;
            const traditional = registrations.filter(r => r.performanceType === 'traditional').length;
            const kpop = registrations.filter(r => r.performanceType === 'kpop').length;
            
            // Calculate recent applications (last 24 hours)
            const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);
            const recent = registrations.filter(r => new Date(r.submittedAt) > oneDayAgo).length;

            document.getElementById('totalCount').textContent = total;
            document.getElementById('traditionalCount').textContent = traditional;
            document.getElementById('kpopCount').textContent = kpop;
            document.getElementById('recentCount').textContent = recent;

            // Add fade-in animation
            document.querySelectorAll('.stat-card').forEach(card => {
                card.classList.add('fade-in');
            });
        }

        // Update chart
        function updateChart() {
            const traditional = registrations.filter(r => r.performanceType === 'traditional').length;
            const kpop = registrations.filter(r => r.performanceType === 'kpop').length;

            const ctx = document.getElementById('performanceChart').getContext('2d');
            
            if (performanceChart) {
                performanceChart.destroy();
            }

            performanceChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['전통무용', 'K-Pop'],
                    datasets: [{
                        data: [traditional, kpop],
                        backgroundColor: [
                            '#DC2626', // Red for traditional
                            '#9333EA'  // Purple for K-Pop
                        ],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    family: 'Noto Sans KR'
                                }
                            }
                        }
                    }
                }
            });
        }

        // Render applications table
        function renderTable() {
            const tbody = document.getElementById('applicationsTable');
            const emptyState = document.getElementById('emptyState');
            
            if (filteredRegistrations.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            
            // Sort by submission date (newest first)
            const sortedData = filteredRegistrations.sort((a, b) => 
                new Date(b.submittedAt) - new Date(a.submittedAt)
            );

            tbody.innerHTML = sortedData.map((reg, index) => `
                <tr class="hover:bg-gray-50 transition-colors">
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        ${index + 1}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${reg.name}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                        ${reg.phone}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                        ${reg.email}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="badge ${reg.performanceType === 'traditional' ? 'badge-traditional' : 'badge-kpop'}">
                            ${reg.performanceType === 'traditional' ? '전통무용' : 'K-Pop'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                        ${formatDateTime(reg.submittedAt)}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="badge ${getStatusBadgeClass(reg.status)}">
                            ${getStatusText(reg.status)}
                            ${reg.isLocalOnly ? ' (로컬)' : ''}
                        </span>
                    </td>
                </tr>
            `).join('');
        }

        // Filter data by performance type
        function filterData() {
            const filterValue = document.getElementById('filterPerformance').value;
            const searchValue = document.getElementById('searchInput').value.toLowerCase();
            
            filteredRegistrations = registrations.filter(reg => {
                const matchesFilter = !filterValue || reg.performanceType === filterValue;
                const matchesSearch = !searchValue || 
                    reg.name.toLowerCase().includes(searchValue) || 
                    reg.email.toLowerCase().includes(searchValue);
                
                return matchesFilter && matchesSearch;
            });
            
            renderTable();
        }

        // Search data
        function searchData() {
            filterData();
        }

        // Format date and time
        function formatDateTime(isoString) {
            const date = new Date(isoString);
            return date.toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Export to CSV
        async function exportToCSV() {
            if (registrations.length === 0) {
                alert('내보낼 데이터가 없습니다.');
                return;
            }

            // Always fetch latest data before export
            try {
                await loadData();
            } catch (error) {
                console.error('최신 데이터 로드 실패, 현재 데이터로 진행:', error);
            }

            const headers = ['번호', '신청ID', '이름', '휴대폰', '이메일', '공연', '신청일시', '상태'];
            const csvContent = [
                headers.join(','),
                ...registrations.map((reg, index) => [
                    index + 1,
                    `"${reg.id || 'N/A'}"`,
                    `"${reg.name}"`,
                    `"${reg.phone}"`,
                    `"${reg.email}"`,
                    `"${reg.performanceType === 'traditional' ? '전통무용' : 'K-Pop'}"`,
                    `"${formatDateTime(reg.submittedAt)}"`,
                    `"${reg.status === 'pending' ? '대기중' : reg.status === 'approved' ? '승인됨' : '거절됨'}"`
                ].join(','))
            ].join('\n');

            const timestamp = new Date().toISOString().slice(0, 16).replace('T', '_').replace(':', '-');
            downloadFile(csvContent, `apec-2025-applications_${timestamp}.csv`, 'text/csv');
        }

        // Export to Excel (CSV format for Excel)
        function exportToExcel() {
            exportToCSV(); // Same as CSV but with .xlsx extension
        }

        // Download file
        function downloadFile(content, filename, mimeType) {
            const blob = new Blob(['\uFEFF' + content], { type: mimeType + ';charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Clear all data
        async function clearAllData() {
            if (registrations.length === 0) {
                alert('삭제할 데이터가 없습니다.');
                return;
            }

            const confirmed = confirm(`정말로 모든 신청 데이터를 삭제하시겠습니까?\n\n총 ${registrations.length}건의 데이터가 완전히 삭제됩니다.\n이 작업은 되돌릴 수 없습니다.`);
            
            if (!confirmed) {
                return;
            }

            showLoading();
            
            try {
                // Clear localStorage first
                localStorage.removeItem('apec_registrations');
                
                // Get all records from API and delete them
                const response = await fetch('tables/apec_applications?limit=1000');
                if (response.ok) {
                    const result = await response.json();
                    
                    // Delete each record
                    const deletePromises = result.data.map(record => 
                        fetch(`tables/apec_applications/${record.id}`, {
                            method: 'DELETE'
                        })
                    );
                    
                    await Promise.allSettled(deletePromises);
                }
                
                // Reload data
                await loadData();
                alert('모든 데이터가 삭제되었습니다.');
                
            } catch (error) {
                console.error('데이터 삭제 중 오류:', error);
                
                // Fallback: clear localStorage only
                localStorage.removeItem('apec_registrations');
                loadData();
                alert('로컬 데이터는 삭제되었지만, 서버 데이터 삭제에 실패했습니다.');
            }
            
            hideLoading();
        }

        // Refresh data
        async function refreshData() {
            await loadData();
            
            // Show success message
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg z-50';
            successDiv.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-check-circle text-green-500 mr-3"></i>
                    <span class="text-green-800 font-semibold">데이터가 새로고침되었습니다</span>
                </div>
            `;
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                if (document.body.contains(successDiv)) {
                    successDiv.remove();
                }
            }, 3000);
        }

        // Show loading
        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('show');
        }

        // Hide loading
        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('show');
        }

        // Update last update time
        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ko-KR', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('lastUpdate').textContent = timeString;
        }
        
        // Get status badge class
        function getStatusBadgeClass(status) {
            switch(status?.toLowerCase()) {
                case 'approved': return 'bg-green-100 text-green-800';
                case 'rejected': return 'bg-red-100 text-red-800';
                case 'pending':
                default: return 'badge-pending';
            }
        }
        
        // Get status text
        function getStatusText(status) {
            switch(status?.toLowerCase()) {
                case 'approved': return '승인됨';
                case 'rejected': return '거절됨';
                case 'pending':
                default: return '대기중';
            }
        }
    </script>
</body>
</html>