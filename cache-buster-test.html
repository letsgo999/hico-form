<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”„ ìºì‹œ ë¬´ì‹œ ìµœì¢… í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-purple-600 to-blue-600 min-h-screen p-8">
    <div class="max-w-2xl mx-auto">
        <div class="bg-white rounded-xl shadow-2xl p-8">
            <h1 class="text-3xl font-bold text-center mb-8 text-purple-800">ğŸ¤ K-Pop ê³µì—° ì‹ ì²­ (ìºì‹œ ë¬´ì‹œ ë²„ì „)</h1>
            
            <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6">
                <strong>âœ… ìµœì‹  ì—…ë°ì´íŠ¸:</strong> 2024.09.30 - ë³´ì•ˆ ê°•í™” ë° ìºì‹œ ë¬¸ì œ í•´ê²°
            </div>
            
            <form id="applicationForm" class="space-y-6">
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">ğŸ‘¤ ì´ë¦„ *</label>
                    <input type="text" id="name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" 
                           placeholder="ì„±í•¨ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">ğŸ“± íœ´ëŒ€í°ë²ˆí˜¸ *</label>
                    <input type="tel" id="phone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" 
                           placeholder="010-1234-5678" pattern="[0-9]{3}-[0-9]{4}-[0-9]{4}" required>
                </div>
                
                <div>
                    <label class="block text-gray-700 font-semibold mb-2">ğŸ“§ ì´ë©”ì¼ *</label>
                    <input type="email" id="email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" 
                           placeholder="example@email.com" required>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="consent" class="mr-3 scale-125" required>
                    <label for="consent" class="text-sm text-gray-700">
                        ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤. *
                    </label>
                </div>
                
                <button type="submit" id="submitBtn" 
                        class="w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white font-bold py-4 px-6 rounded-lg hover:from-purple-700 hover:to-blue-700 transform transition duration-200 hover:scale-105 shadow-lg">
                    ğŸ¯ ìºì‹œ ë¬´ì‹œ ì‹ ì²­í•˜ê¸° (ìµœì‹  ë²„ì „)
                </button>
            </form>
            
            <div id="status" class="mt-6 p-4 bg-gray-900 text-green-400 rounded-lg font-mono text-sm max-h-64 overflow-y-auto">
                <div class="text-yellow-400">ğŸ”„ ìºì‹œ ë¬´ì‹œ ìµœì‹  ë²„ì „ ë¡œë“œ ì™„ë£Œ (2024.09.30)</div>
                <div class="text-blue-400">ğŸ“¡ Functions URL: /.netlify/functions/airtable-proxy</div>
                <div class="text-purple-400">ğŸš€ ë¸Œë¼ìš°ì € ìºì‹œë¥¼ ì™„ì „ ë¬´ì‹œí•˜ëŠ” ìµœì‹  ì½”ë“œì…ë‹ˆë‹¤</div>
            </div>
        </div>
    </div>

    <script>
        // ğŸ”„ ìºì‹œ ë¬´ì‹œ ìµœì‹  ë²„ì „ - 2024.09.30
        const FUNCTIONS_URL = '/.netlify/functions/airtable-proxy';
        
        function log(message, type = 'info') {
            const container = document.getElementById('status');
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                'error': 'text-red-400',
                'success': 'text-green-400',
                'warning': 'text-yellow-400',
                'info': 'text-blue-400'
            };
            
            container.innerHTML += `<div class="${colors[type] || 'text-green-400'}">[${timestamp}] ${message}</div>`;
            container.scrollTop = container.scrollHeight;
        }

        document.getElementById('applicationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = 'ğŸ”„ ì²˜ë¦¬ì¤‘...';
            
            // í¼ ë°ì´í„° ìˆ˜ì§‘
            const formData = {
                'Name': document.getElementById('name').value,
                'Phone': document.getElementById('phone').value,
                'Email': document.getElementById('email').value,
                'Performance Type': 'K-Pop',
                'Status': 'Pending',
                'Submitted At': new Date().toISOString()
            };
            
            log('ğŸš€ ìºì‹œ ë¬´ì‹œ ì‹ ì²­ ì‹œì‘...', 'warning');
            log('ğŸ“ ì „ì†¡ ë°ì´í„°: ' + JSON.stringify(formData, null, 2), 'info');
            log('ğŸ”— ì‚¬ìš© URL: ' + FUNCTIONS_URL, 'info');
            
            try {
                // ìºì‹œ ë¬´ì‹œ í—¤ë” ì¶”ê°€
                const response = await fetch(FUNCTIONS_URL + '?t=' + Date.now(), {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    },
                    body: JSON.stringify(formData)
                });
                
                log(`ğŸ“¡ ì‘ë‹µ ìƒíƒœ: ${response.status} ${response.statusText}`, 
                    response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const result = await response.json();
                    log('âœ… ì‹ ì²­ ì„±ê³µ! ë ˆì½”ë“œ ID: ' + result.id, 'success');
                    log('ğŸ‰ ì—ì–´í…Œì´ë¸”ì— ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                    
                    // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                    alert('ğŸ‰ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\n' +
                          'ğŸ“§ ì…ë ¥í•˜ì‹  ì´ë©”ì¼ë¡œ í™•ì¸ ë©”ì‹œì§€ê°€ ë°œì†¡ë  ì˜ˆì •ì…ë‹ˆë‹¤.\n' +
                          'ğŸ« ë‹¹ì²¨ì ë°œí‘œëŠ” 10ì›” 27ì¼(ì›”) ì˜¤ì „ 9ì‹œì— ìˆì„ ì˜ˆì •ì…ë‹ˆë‹¤.');
                    
                    // í¼ ì´ˆê¸°í™”
                    document.getElementById('applicationForm').reset();
                    
                } else {
                    const errorText = await response.text();
                    log('âŒ ì‹ ì²­ ì‹¤íŒ¨: ' + errorText, 'error');
                    alert('âŒ ì‹ ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\në‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
                }
                
            } catch (error) {
                log('ğŸ’¥ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ' + error.message, 'error');
                alert('ğŸ’¥ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\nì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'ğŸ¯ ìºì‹œ ë¬´ì‹œ ì‹ ì²­í•˜ê¸° (ìµœì‹  ë²„ì „)';
            }
        });
        
        // í˜ì´ì§€ ë¡œë“œì‹œ ìµœì‹  ë²„ì „ì„ì„ ì•Œë¦¼
        window.addEventListener('load', () => {
            log('âœ… ìµœì‹  ë²„ì „ ë¡œë“œ ì™„ë£Œ - ìºì‹œ ë¬´ì‹œ ê¸°ëŠ¥ ì ìš©ë¨', 'success');
        });
    </script>
</body>
</html>